build:
.PHONY: build

SITE=@SITE@
PACKAGE=$(shell echo $(SITE) | sed -e 's/\./-/g')

Makefile: ../skeleton/Makefile
	echo "# Autogenerated Makefile at `date`"  >$@
	echo "# DO NOT EDIT THIS FILE!"           >>$@
	echo                                      >>$@
	cat ../skeleton/Makefile                  >>$@
	sed -i -e 's/[@]SITE@/$(SITE)/g' $@

install: install-httpd
.PHONY: install

install-httpd: $(HTTPDETC)
	mkdir -p $(HTTPDETC)/sites.d
	cp httpd.conf $(HTTPDETC)/sites.d/$(PACKAGE).conf
	# Use [@] to ensure we don't get substitutions
	find $(HTTPDETC) -name '*.conf' | xargs sed -i \
		-e "s/[@]SERVER_NAME@/$(SERVER_NAME)/g" \
		-e "s/[@]PACKAGE@/$(PACKAGE)/g" \
		-e "s/[@]IP@/$(IP)/g" \
		-e "s/[@]PORT@/$(PORT)/g" \
		-e "s/[@]LISTEN_DIRECTIVE@/$(LISTEN_DIRECTIVE)/g"

.PHONY: install-httpd

uninstall:
.PHONY: uninstall

clean:
.PHONY: clean
